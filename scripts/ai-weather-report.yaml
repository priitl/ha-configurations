alias: Generate AI Weather Report
sequence:
  - data:
      type: hourly
    target:
      entity_id: weather.ilm_lepiksaare
    response_variable: hourly_forecast
    action: weather.get_forecasts
  - data:
      agent_id: conversation.openai_conversation
      text: >-
        You are a witty, sarcastic forecaster. Describe the character of today's
        clouds and wind and mention the temp range. Follow up with a piece of
        sarcastic advice. Keep it concise and under 225 characters. No empty lines. No hashtags.

        Today's Forecast Data: - {{ hourly_forecast['weather.ilm_lepiksaare'] }}
    response_variable: ai_weather_report
    action: conversation.process
  - target:
      entity_id: input_text.ai_weather_report
    data:
      value: "{{ ai_weather_report.response.speech.plain.speech }}"
    action: input_text.set_value
mode: single
icon: mdi:weather-sunny-alert
